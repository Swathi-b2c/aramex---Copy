{"ast":null,"code":"import React from'react';import{Route,Routes,Navigate}from'react-router-dom';import Navbar from'./components/Navbar';import HomePage from'./pages/HomePage';import AdvancedAuthentication from'./pages/AdvancedAuthentication';import Footer from'./components/Footer';import OurCompany from'./pages/OurCompany';import{useIsAuthenticated,useMsal}from'@azure/msal-react';import SinglesignOn from'./pages/SinglesignOn';import ProfilePage from'./pages/ProfilePage';import{useState,useEffect}from'react';import Unauthorized from\"./pages/Unauthorized\";import AdminPage from\"./pages/AdminPage\";// Example admin page\nimport UserPage from\"./pages/UserPage\";// Example user page\nimport ProtectedRoute from\"./components/ProtectedRoute\";import TrackerPortal from'./pages/TrackerPortal';import{Link}from'react-router-dom';import PhotoGallery from'./components/PhotoGallery';import ChatPage from'./pages/ChatPage';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function App(){var _accounts$,_accounts$$idTokenCla;const isAuthenticated=useIsAuthenticated();const{accounts,instance}=useMsal();const[user,setUser]=useState(null);const[userDetails,setUserDetails]=useState(null);const userLoginMethod=accounts===null||accounts===void 0?void 0:(_accounts$=accounts[0])===null||_accounts$===void 0?void 0:(_accounts$$idTokenCla=_accounts$.idTokenClaims)===null||_accounts$$idTokenCla===void 0?void 0:_accounts$$idTokenCla.loginMethod;// Check login method (B2C or Entra)\nconst roles=(userDetails===null||userDetails===void 0?void 0:userDetails.roles)||[];useEffect(()=>{// Update userDetails after login\nif(isAuthenticated&&accounts&&accounts.length>0){const account=accounts[0];const idTokenClaims=account.idTokenClaims||{};let loginMethod='Unknown';if(idTokenClaims.tfp){loginMethod='B2C';}else{loginMethod='EntraID';}console.log('Login Method:',loginMethod);// Add this line\nconsole.log('ID Token Claims:',idTokenClaims);// Add this line\nsetUserDetails({name:idTokenClaims.name||account.username||'User',username:account.username||'Unknown User',roles:Array.isArray(idTokenClaims.roles)?idTokenClaims.roles:[],idTokenClaims,loginMethod});}},[isAuthenticated,accounts]);return/*#__PURE__*/_jsxs(\"div\",{className:\"App\",children:[/*#__PURE__*/_jsx(Navbar,{userDetails:userDetails,setUserDetails:setUserDetails}),/*#__PURE__*/_jsxs(Routes,{children:[/*#__PURE__*/_jsx(Route,{path:\"/\",element:/*#__PURE__*/_jsx(HomePage,{})}),(userDetails===null||userDetails===void 0?void 0:userDetails.loginMethod)==='B2C'?/*#__PURE__*/_jsx(Route,{path:\"/tracker\",element:/*#__PURE__*/_jsx(TrackerPortal,{})}):/*#__PURE__*/_jsx(Route,{path:\"/profile\",element:/*#__PURE__*/_jsx(ProfilePage,{})}),/*#__PURE__*/_jsx(Route,{path:\"/home\",element:/*#__PURE__*/_jsx(HomePage,{})}),/*#__PURE__*/_jsx(Route,{path:\"/advanced-authentication\",element:/*#__PURE__*/_jsx(AdvancedAuthentication,{})}),/*#__PURE__*/_jsx(Route,{path:\"/ourcompany\",element:/*#__PURE__*/_jsx(OurCompany,{})}),/*#__PURE__*/_jsx(Route,{path:\"/single-signon\",element:/*#__PURE__*/_jsx(SinglesignOn,{})}),/*#__PURE__*/_jsx(Route,{path:\"/profile\",element:/*#__PURE__*/_jsx(ProfilePage,{user:userDetails})}),/*#__PURE__*/_jsx(Route,{path:\"/import-photos\",element:/*#__PURE__*/_jsx(PhotoGallery,{})}),/*#__PURE__*/_jsx(Route,{path:\"/chat\",element:/*#__PURE__*/_jsx(ProtectedRoute,{isAuthenticated:!!userDetails,children:/*#__PURE__*/_jsx(ChatPage,{})})}),/*#__PURE__*/_jsx(Route,{path:\"/unauthorized\",element:/*#__PURE__*/_jsx(Unauthorized,{})}),/*#__PURE__*/_jsx(Route,{path:\"/admin\",element:/*#__PURE__*/_jsx(ProtectedRoute,{isAuthenticated:!!userDetails,roles:['Admin'],userRoles:(userDetails===null||userDetails===void 0?void 0:userDetails.roles)||[],children:/*#__PURE__*/_jsx(AdminPage,{})})}),/*#__PURE__*/_jsx(Route,{path:\"/user\",element:/*#__PURE__*/_jsx(ProtectedRoute,{roles:[\"User\"],userRoles:(userDetails===null||userDetails===void 0?void 0:userDetails.roles)||[],children:/*#__PURE__*/_jsx(UserPage,{})})}),/*#__PURE__*/_jsx(Route,{path:\"*\",element:/*#__PURE__*/_jsx(Navigate,{to:\"/\"})})]}),/*#__PURE__*/_jsx(Footer,{})]});}export default App;","map":{"version":3,"names":["React","Route","Routes","Navigate","Navbar","HomePage","AdvancedAuthentication","Footer","OurCompany","useIsAuthenticated","useMsal","SinglesignOn","ProfilePage","useState","useEffect","Unauthorized","AdminPage","UserPage","ProtectedRoute","TrackerPortal","Link","PhotoGallery","ChatPage","jsx","_jsx","jsxs","_jsxs","App","_accounts$","_accounts$$idTokenCla","isAuthenticated","accounts","instance","user","setUser","userDetails","setUserDetails","userLoginMethod","idTokenClaims","loginMethod","roles","length","account","tfp","console","log","name","username","Array","isArray","className","children","path","element","userRoles","to"],"sources":["C:/aramex - Copy/frontend/src/App.js"],"sourcesContent":["import React from 'react';\r\nimport { Route, Routes , Navigate} from 'react-router-dom';\r\nimport Navbar from './components/Navbar';\r\nimport HomePage from './pages/HomePage';\r\nimport AdvancedAuthentication from './pages/AdvancedAuthentication';\r\nimport Footer from './components/Footer';\r\nimport OurCompany from './pages/OurCompany';\r\nimport { useIsAuthenticated, useMsal } from '@azure/msal-react';\r\nimport SinglesignOn from './pages/SinglesignOn';\r\nimport ProfilePage from './pages/ProfilePage';\r\nimport  { useState , useEffect } from 'react';\r\nimport Unauthorized from \"./pages/Unauthorized\";\r\nimport AdminPage from \"./pages/AdminPage\"; // Example admin page\r\nimport UserPage from \"./pages/UserPage\"; // Example user page\r\nimport ProtectedRoute from \"./components/ProtectedRoute\";\r\nimport TrackerPortal from './pages/TrackerPortal';\r\nimport { Link } from 'react-router-dom';\r\nimport PhotoGallery from './components/PhotoGallery';\r\nimport ChatPage from './pages/ChatPage';\r\n\r\n\r\n\r\nfunction App() {\r\n  const isAuthenticated = useIsAuthenticated();\r\n  const { accounts , instance} = useMsal();\r\n  const [user, setUser] = useState(null);\r\n  const [userDetails, setUserDetails] = useState(null); \r\n  const userLoginMethod = accounts?.[0]?.idTokenClaims?.loginMethod; // Check login method (B2C or Entra)\r\n  const roles = userDetails?.roles || []; \r\n\r\n  useEffect(() => {\r\n    // Update userDetails after login\r\n    if (isAuthenticated && accounts && accounts.length > 0) {\r\n      const account = accounts[0];\r\n      const idTokenClaims = account.idTokenClaims || {};\r\n      let loginMethod = 'Unknown';\r\n      if (idTokenClaims.tfp) {\r\n        loginMethod = 'B2C';\r\n      } else {\r\n        loginMethod = 'EntraID';\r\n      }\r\n  \r\n      console.log('Login Method:', loginMethod); // Add this line\r\n      console.log('ID Token Claims:', idTokenClaims); // Add this line\r\n  \r\n      setUserDetails({\r\n        name: idTokenClaims.name || account.username || 'User',\r\n        username: account.username || 'Unknown User',\r\n        roles: Array.isArray(idTokenClaims.roles) ? idTokenClaims.roles : [],\r\n        idTokenClaims,\r\n        loginMethod,\r\n      });\r\n    }\r\n  }, [isAuthenticated, accounts]);\r\n  \r\n  \r\n  return (\r\n    <div className=\"App\">\r\n      <Navbar userDetails={userDetails} setUserDetails={setUserDetails} />\r\n      <Routes>\r\n        <Route path=\"/\" element={<HomePage />} />\r\n        {userDetails?.loginMethod === 'B2C' ? (\r\n    <Route path=\"/tracker\" element={<TrackerPortal />} />\r\n  ) : (\r\n    <Route path=\"/profile\" element={<ProfilePage />} />\r\n  )}\r\n        <Route path=\"/home\" element={<HomePage />} />\r\n        <Route path=\"/advanced-authentication\" element={<AdvancedAuthentication />} />\r\n        <Route path=\"/ourcompany\" element={<OurCompany />} />\r\n        <Route path=\"/single-signon\" element={<SinglesignOn />} />\r\n        <Route path=\"/profile\" element={<ProfilePage user={userDetails} />} />\r\n        <Route path=\"/import-photos\" element={<PhotoGallery />} />\r\n        <Route\r\n  path=\"/chat\"\r\n  element={\r\n    <ProtectedRoute isAuthenticated={!!userDetails}>\r\n      <ChatPage />\r\n    </ProtectedRoute>\r\n  }\r\n/>\r\n\r\n\r\n        <Route path=\"/unauthorized\" element={<Unauthorized />} />\r\n        <Route\r\n  path=\"/admin\"\r\n  element={\r\n    <ProtectedRoute\r\n      isAuthenticated={!!userDetails}\r\n      roles={['Admin']}\r\n      userRoles={userDetails?.roles || []}\r\n    >\r\n      <AdminPage />\r\n    </ProtectedRoute>\r\n  }\r\n\r\n  />\r\n  <Route\r\n    path=\"/user\"\r\n    element={\r\n      <ProtectedRoute roles={[\"User\"]} userRoles={userDetails?.roles || []}>\r\n        <UserPage />\r\n      </ProtectedRoute>\r\n    }\r\n  />\r\n  {/* Catch-all route */}\r\n  <Route path=\"*\" element={<Navigate to=\"/\" />} />\r\n      </Routes>\r\n      <Footer />\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default App;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}